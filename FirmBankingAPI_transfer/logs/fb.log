[2022-08-16 09:38:33.743:1221][main] INFO  c.i.fb.FirmBankingApiApplication - Starting FirmBankingApiApplication using Java 11.0.11 on Kimui-MacBookPro.local with PID 3713 (/Users/skwx50000/Desktop/spring/firmBankingService/FirmBankingAPI_transfer/build/classes/java/main started by skwx50000 in /Users/skwx50000/Desktop/spring/firmBankingService/FirmBankingAPI_transfer)
[2022-08-16 09:38:33.753:1231][main] DEBUG c.i.fb.FirmBankingApiApplication - Running with Spring Boot v2.6.7, Spring v5.3.19
[2022-08-16 09:38:33.754:1232][main] INFO  c.i.fb.FirmBankingApiApplication - No active profile set, falling back to 1 default profile: "default"
[2022-08-16 09:38:38.843:6321][main] INFO  c.i.fb.FirmBankingApiApplication - Started FirmBankingApiApplication in 6.084 seconds (JVM running for 6.794)
[2022-08-16 09:38:38.852:6330][main] DEBUG c.i.fb.FirmBankingApiApplication - ----------------------------------------
[2022-08-16 09:38:38.853:6331][main] DEBUG c.i.fb.FirmBankingApiApplication - start local cache initializing
[2022-08-16 09:38:38.853:6331][main] DEBUG c.i.fb.FirmBankingApiApplication - ----------------------------------------
[2022-08-16 09:38:38.999:6477][main] DEBUG c.i.f.mapper.CustMstMapper.initData - ==>  Preparing: SELECT OrgCd FROM CustMst WHERE InUse = "Y"
[2022-08-16 09:38:39.014:6492][main] DEBUG c.i.f.mapper.CustMstMapper.initData - ==> Parameters: 
[2022-08-16 09:38:39.043:6521][main] DEBUG c.i.f.mapper.CustMstMapper.initData - <==      Total: 16
[2022-08-16 09:38:39.074:6552][main] DEBUG c.i.f.m.CustMstMapper.selectOne - ==>  Preparing: SELECT * FROM CustMst WHERE OrgCd = ?
[2022-08-16 09:38:39.077:6555][main] DEBUG c.i.f.m.CustMstMapper.selectOne - ==> Parameters: 10000262(String)
[2022-08-16 09:38:39.088:6566][main] DEBUG c.i.f.m.CustMstMapper.selectOne - <==      Total: 1
[2022-08-16 09:38:39.090:6568][main] DEBUG c.i.f.m.CustMstMapper.selectOne - ==>  Preparing: SELECT * FROM CustMst WHERE OrgCd = ?
[2022-08-16 09:38:39.090:6568][main] DEBUG c.i.f.m.CustMstMapper.selectOne - ==> Parameters: 10000263(String)
[2022-08-16 09:38:39.100:6578][main] DEBUG c.i.f.m.CustMstMapper.selectOne - <==      Total: 1
[2022-08-16 09:38:39.100:6578][main] DEBUG c.i.f.m.CustMstMapper.selectOne - ==>  Preparing: SELECT * FROM CustMst WHERE OrgCd = ?
[2022-08-16 09:38:39.101:6579][main] DEBUG c.i.f.m.CustMstMapper.selectOne - ==> Parameters: 10000264(String)
[2022-08-16 09:38:39.109:6587][main] DEBUG c.i.f.m.CustMstMapper.selectOne - <==      Total: 1
[2022-08-16 09:38:39.111:6589][main] DEBUG c.i.f.m.CustMstMapper.selectOne - ==>  Preparing: SELECT * FROM CustMst WHERE OrgCd = ?
[2022-08-16 09:38:39.111:6589][main] DEBUG c.i.f.m.CustMstMapper.selectOne - ==> Parameters: 10000265(String)
[2022-08-16 09:38:39.120:6598][main] DEBUG c.i.f.m.CustMstMapper.selectOne - <==      Total: 1
[2022-08-16 09:38:39.122:6600][main] DEBUG c.i.f.m.CustMstMapper.selectOne - ==>  Preparing: SELECT * FROM CustMst WHERE OrgCd = ?
[2022-08-16 09:38:39.122:6600][main] DEBUG c.i.f.m.CustMstMapper.selectOne - ==> Parameters: test(String)
[2022-08-16 09:38:39.143:6621][main] DEBUG c.i.f.m.CustMstMapper.selectOne - <==      Total: 12
[2022-08-16 09:38:39.144:6622][main] DEBUG c.i.fb.FirmBankingApiApplication - ----------------------------------------
[2022-08-16 09:38:39.144:6622][main] DEBUG c.i.fb.FirmBankingApiApplication - complete local cache initializing
[2022-08-16 09:38:39.144:6622][main] DEBUG c.i.fb.FirmBankingApiApplication - ----------------------------------------
[2022-08-16 09:40:42.156:129634][https-jsse-nio-9000-exec-3] DEBUG com.inspien.fb.FirmAPIController - accessCount=0, POST, 390, /api/rt/v1/transfer
[2022-08-16 09:40:42.163:129641][https-jsse-nio-9000-exec-3] INFO  com.inspien.fb.FirmAPIController - custData : [CustMst(CustId=0000000001, CustNm=SAP테스트, OrgCd=10000262, CallbackURL=https://p200029-iflmap.hcisbp.ap1.hana.ondemand.com/http/BankStatementPost, ApiKey=7242191d-865c-48df-aa02-e3cf10bffd6d, PriContactNm=test, PriContactTel=asdasd, PriContactEmail=test@test.com, SecContactNm=null, SecContactTel=null, SecContactEmail=null, TxSequence=@, InUse=Y)]
[2022-08-16 09:40:42.185:129663][https-jsse-nio-9000-exec-3] INFO  com.inspien.fb.FirmAPIController - TransferRequest=10000262,TransferRequest(api_key=7242191d-865c-48df-aa02-e3cf10bffd6d, org_code=10000262, drw_bank_code=088, telegram_no=0, drw_account=832210312031, drw_account_cntn=문세인, rv_bank_code=081, rv_account=46291012501007, rv_account_cntn=핍랄샐, amount=1000, tr_dt=20220816, tr_tm=155011, msg_id=1)
[2022-08-16 09:40:42.212:129690][https-jsse-nio-9000-exec-3] DEBUG c.i.f.m.TxStatMapper.insertTxStat - ==>  Preparing: INSERT INTO TxStat( CustId, OrgCd, TxDate, BankCd, TxType, TxCnt, TxSize ) VALUES( ?,?,?,?,?,?,?) ON DUPLICATE KEY UPDATE TxCnt =TxCnt+ ?,TxSize = TxSize+ ?
[2022-08-16 09:40:42.213:129691][https-jsse-nio-9000-exec-3] DEBUG c.i.f.m.TxStatMapper.insertTxStat - ==> Parameters: 0000000001(String), 10000262(String), 20220816094042(String), 081(String), 1(String), 1(Long), 390(Long), 1(Long), 390(Long)
[2022-08-16 09:40:42.226:129704][https-jsse-nio-9000-exec-3] DEBUG c.i.f.m.TxStatMapper.insertTxStat - <==    Updates: 1
[2022-08-16 09:40:42.253:129731][https-jsse-nio-9000-exec-3] DEBUG c.i.f.m.CustMstMapper.selectOne - ==>  Preparing: SELECT * FROM CustMst WHERE OrgCd = ?
[2022-08-16 09:40:42.254:129732][https-jsse-nio-9000-exec-3] DEBUG c.i.f.m.CustMstMapper.selectOne - ==> Parameters: 10000262(String)
[2022-08-16 09:40:42.263:129741][https-jsse-nio-9000-exec-3] DEBUG c.i.f.m.CustMstMapper.selectOne - <==      Total: 1
[2022-08-16 09:40:42.264:129742][https-jsse-nio-9000-exec-3] DEBUG c.i.f.m.T.isExistTxTrace - ==>  Preparing: SELECT EXISTS( SELECT * FROM TxTrace WHERE CustId = ? AND TxDate = ?)
[2022-08-16 09:40:42.265:129743][https-jsse-nio-9000-exec-3] DEBUG c.i.f.m.T.isExistTxTrace - ==> Parameters: 0000000001(String), 20220816(String)
[2022-08-16 09:40:42.279:129757][https-jsse-nio-9000-exec-3] DEBUG c.i.f.m.T.isExistTxTrace - <==      Total: 1
[2022-08-16 09:40:42.281:129759][https-jsse-nio-9000-exec-3] INFO  com.inspien.fb.svc.FBService - 개시전문 여부 : false
[2022-08-16 09:40:42.281:129759][https-jsse-nio-9000-exec-3] INFO  com.inspien.fb.svc.FBService - start openReq
[2022-08-16 09:40:42.282:129760][https-jsse-nio-9000-exec-3] DEBUG c.i.f.m.TxTraceMapper.upsertTxTrace - ==>  Preparing: INSERT INTO TxTrace( CustId, OrgCd, TxDate, TxSequence, TxStarted ) VALUES ( ?,?,?,?,?) ON DUPLICATE KEY UPDATE TxSequence = TxSequence+1
[2022-08-16 09:40:42.282:129760][https-jsse-nio-9000-exec-3] DEBUG c.i.f.m.TxTraceMapper.upsertTxTrace - ==> Parameters: 0000000001(String), 10000262(String), 20220816(String), 1(String), Y(String)
[2022-08-16 09:40:42.292:129770][https-jsse-nio-9000-exec-3] DEBUG c.i.f.m.TxTraceMapper.upsertTxTrace - <==    Updates: 1
[2022-08-16 09:40:42.315:129793][https-jsse-nio-9000-exec-3] DEBUG com.inspien.fb.svc.VANProxy - ----------------------------------------
[2022-08-16 09:40:42.315:129793][https-jsse-nio-9000-exec-3] DEBUG com.inspien.fb.svc.VANProxy - Executing request POST https://test-gw-firm.dozn.co.kr/api/rt/v1/account/open ==> {
  "api_key" : "7242191d-865c-48df-aa02-e3cf10bffd6d",
  "org_code" : "10000262",
  "drw_bank_code" : "088",
  "telegram_no" : 1
}
[2022-08-16 09:40:42.560:130038][https-jsse-nio-9000-exec-3] DEBUG com.inspien.fb.svc.VANProxy - ----------------------------------------
[2022-08-16 09:40:42.560:130038][https-jsse-nio-9000-exec-3] DEBUG com.inspien.fb.svc.VANProxy - 200 200 ==> {"status":200,"drw_bank_code":"088","open_state":"SUCCESS"}
[2022-08-16 09:40:42.560:130038][https-jsse-nio-9000-exec-3] DEBUG com.inspien.fb.svc.VANProxy - SSL protocol TLSv1.2, cipher suite TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
[2022-08-16 09:40:42.568:130046][https-jsse-nio-9000-exec-3] DEBUG c.i.f.m.CustMstMapper.selectOne - ==>  Preparing: SELECT * FROM CustMst WHERE OrgCd = ?
[2022-08-16 09:40:42.569:130047][https-jsse-nio-9000-exec-3] DEBUG c.i.f.m.CustMstMapper.selectOne - ==> Parameters: 10000262(String)
[2022-08-16 09:40:42.578:130056][https-jsse-nio-9000-exec-3] DEBUG c.i.f.m.CustMstMapper.selectOne - <==      Total: 1
[2022-08-16 09:40:42.578:130056][https-jsse-nio-9000-exec-3] DEBUG c.i.fb.svc.FileTelegramManager - getNextCounter.custCounter : {}
[2022-08-16 09:40:42.578:130056][https-jsse-nio-9000-exec-3] DEBUG c.i.f.m.TxTraceMapper.upsertTxTrace - ==>  Preparing: INSERT INTO TxTrace( CustId, OrgCd, TxDate, TxSequence, TxStarted ) VALUES ( ?,?,?,?,?) ON DUPLICATE KEY UPDATE TxSequence = TxSequence+1
[2022-08-16 09:40:42.579:130057][https-jsse-nio-9000-exec-3] DEBUG c.i.f.m.TxTraceMapper.upsertTxTrace - ==> Parameters: 0000000001(String), 10000262(String), 20220816(String), 1(String), Y(String)
[2022-08-16 09:40:42.590:130068][https-jsse-nio-9000-exec-3] DEBUG c.i.f.m.TxTraceMapper.upsertTxTrace - <==    Updates: 2
[2022-08-16 09:40:42.591:130069][https-jsse-nio-9000-exec-3] DEBUG c.i.f.m.TxTraceMapper.selectTxTrace - ==>  Preparing: SELECT IFNULL(TxTrace.TxSequence,'0') FROM TxTrace WHERE CustId = ? AND TxDate = ?
[2022-08-16 09:40:42.591:130069][https-jsse-nio-9000-exec-3] DEBUG c.i.f.m.TxTraceMapper.selectTxTrace - ==> Parameters: 0000000001(String), 20220816(String)
[2022-08-16 09:40:42.601:130079][https-jsse-nio-9000-exec-3] DEBUG c.i.f.m.TxTraceMapper.selectTxTrace - <==      Total: 1
[2022-08-16 09:40:42.604:130082][https-jsse-nio-9000-exec-3] INFO  com.inspien.fb.svc.FBService - txNo : 2
[2022-08-16 09:40:42.607:130085][https-jsse-nio-9000-exec-3] DEBUG com.inspien.fb.svc.VANProxy - ----------------------------------------
[2022-08-16 09:40:42.607:130085][https-jsse-nio-9000-exec-3] DEBUG com.inspien.fb.svc.VANProxy - Executing request POST https://test-gw-firm.dozn.co.kr/api/rt/v1/transfer ==> {
  "api_key" : "7242191d-865c-48df-aa02-e3cf10bffd6d",
  "org_code" : "10000262",
  "drw_bank_code" : "088",
  "telegram_no" : 2,
  "drw_account" : "832210312031",
  "drw_account_cntn" : "문세인",
  "rv_bank_code" : "081",
  "rv_account" : "46291012501007",
  "rv_account_cntn" : "핍랄샐",
  "amount" : 1000,
  "tr_dt" : "20220816",
  "tr_tm" : "155011",
  "msg_id" : "1"
}
[2022-08-16 09:40:50.271:137749][https-jsse-nio-9000-exec-3] DEBUG com.inspien.fb.svc.VANProxy - ----------------------------------------
[2022-08-16 09:40:50.271:137749][https-jsse-nio-9000-exec-3] DEBUG com.inspien.fb.svc.VANProxy - 200 200 ==> {"status":200,"natv_tr_no":"20220816002089000001","request_at":"20220816094050","amount":1000}
[2022-08-16 09:40:50.271:137749][https-jsse-nio-9000-exec-3] DEBUG com.inspien.fb.svc.VANProxy - SSL protocol TLSv1.2, cipher suite TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
[2022-08-16 09:40:50.336:137814][https-jsse-nio-9000-exec-3] INFO  com.inspien.fb.WriteLogs - start db insert
[2022-08-16 09:40:50.354:137832][https-jsse-nio-9000-exec-3] DEBUG c.i.f.m.TxTraceMapper.selectTxTrace - ==>  Preparing: SELECT IFNULL(TxTrace.TxSequence,'0') FROM TxTrace WHERE CustId = ? AND TxDate = ?
[2022-08-16 09:40:50.357:137835][https-jsse-nio-9000-exec-3] DEBUG c.i.f.m.TxTraceMapper.selectTxTrace - ==> Parameters: 0000000001(String), 2022-08-16(String)
[2022-08-16 09:40:50.370:137848][https-jsse-nio-9000-exec-3] DEBUG c.i.f.m.TxTraceMapper.selectTxTrace - <==      Total: 1
[2022-08-16 09:40:50.406:137884][https-jsse-nio-9000-exec-3] DEBUG com.inspien.fb.WriteLogs - txlog : TxLog(TxIdx=20220816094042001, CustId=0000000001, OrgCd=10000262, TxDate=2022-08-16, TelegramNo=2, MsgId=1, TxType=1, BankCd=081, Size=390, RoundTrip=8.131073834, StmtCnt=1, Status=200, StartDT=2022-08-16 09:40:42.154, EndDT=2022-08-16 09:40:50.286, EncData={
    "api_key" : "7242191d-865c-48df-aa02-e3cf10bffd6d", 
    "org_code" : "10000262", 
    "drw_bank_code" : "088", 
    "drw_account" : "832210312031", 
    "drw_account_cntn" : "문세인",
    "rv_bank_code" : "081", 
    "rv_account" : "46291012501007", 
    "rv_account_cntn" : "핍랄샐",
    "amount" : 1000,
    "tr_dt" : "20220816", 
    "tr_tm" : "155011",
    "msg_id" : "1"
}, NatvTrNo=20220816002089000001, ErrCode=null, ErrMsg=null)
[2022-08-16 09:40:50.537:138015][https-jsse-nio-9000-exec-3] DEBUG c.i.fb.mapper.TxLogMapper.logAdd - ==>  Preparing: INSERT INTO TxLog( TxIdx, CustId, OrgCd, TxDate, TelegramNo, MsgId, TxType, BankCd, Size, RoundTrip, StmtCnt, Status, StartDT, EndDT, EncData, NatvTrNo, ErrCode, ErrMsg ) values( ?,?,?,?,?,?,?,?, ?,?,?,?,?,?, HEX(AES_ENCRYPT(?,SHA2(?,512))),?,?,?)
[2022-08-16 09:40:50.615:138093][https-jsse-nio-9000-exec-3] DEBUG c.i.fb.mapper.TxLogMapper.logAdd - ==> Parameters: 20220816094042001(String), 0000000001(String), 10000262(String), 2022-08-16(String), 2(String), 1(String), 1(String), 081(String), 390(Long), 8.131073834(BigDecimal), 1(Integer), 200(String), 2022-08-16 09:40:42.154(Timestamp), 2022-08-16 09:40:50.286(Timestamp), {
    "api_key" : "7242191d-865c-48df-aa02-e3cf10bffd6d", 
    "org_code" : "10000262", 
    "drw_bank_code" : "088", 
    "drw_account" : "832210312031", 
    "drw_account_cntn" : "문세인",
    "rv_bank_code" : "081", 
    "rv_account" : "46291012501007", 
    "rv_account_cntn" : "핍랄샐",
    "amount" : 1000,
    "tr_dt" : "20220816", 
    "tr_tm" : "155011",
    "msg_id" : "1"
}(String), test(String), 20220816002089000001(String), null, null
[2022-08-16 09:40:50.636:138114][https-jsse-nio-9000-exec-3] DEBUG c.i.fb.mapper.TxLogMapper.logAdd - <==    Updates: 1
